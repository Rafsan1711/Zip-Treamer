## Notebook Name: Chessmate Data Prep.ipynb

---

## 1. Introduction
eta amar  GambitFlow/Nexus-Core ei model er dataset bananor notebook. 

---

### Cell 1
```python

# ‡ßß. ‡¶≤‡¶æ‡¶á‡¶¨‡ßç‡¶∞‡ßá‡¶∞‡¶ø ‡¶á‡¶®‡ßç‡¶∏‡¶ü‡¶≤
!pip install python-chess zstandard

import chess.pgn
import zstandard as zstd
import io
import os
import requests
from google.colab import drive

# ‡ß®. ‡¶°‡ßç‡¶∞‡¶æ‡¶á‡¶≠ ‡¶Æ‡¶æ‡¶â‡¶®‡ßç‡¶ü
drive.mount('/content/drive')

# ‡ß©. ‡¶ï‡¶æ‡¶ú‡ßá‡¶∞ ‡¶´‡ßã‡¶≤‡ßç‡¶°‡¶æ‡¶∞ ‡¶∏‡ßá‡¶ü ‡¶ï‡¶∞‡¶æ (v2)
base_path = '/content/drive/MyDrive/Chessmate_Project/v2'
os.makedirs(base_path, exist_ok=True)

print(f"Working directory: {base_path}")

# ‡¶è‡¶ü‡¶ø ‡¶¨‡ßç‡¶∞‡¶æ‡¶â‡¶ú‡¶æ‡¶∞‡¶ï‡ßá ‡¶ò‡ßÅ‡¶Æ‡¶ø‡ßü‡ßá ‡¶™‡ßú‡¶æ ‡¶•‡ßá‡¶ï‡ßá ‡¶¨‡¶æ‡¶Å‡¶ö‡¶æ‡¶¨‡ßá
def keep_colab_awake():
    import time
    while True:
        # ‡¶™‡ßç‡¶∞‡¶§‡¶ø 60 ‡¶∏‡ßá‡¶ï‡ßá‡¶®‡ßç‡¶°‡ßá ‡¶è‡¶ï‡¶¨‡¶æ‡¶∞ ‡¶ú‡¶æ‡¶≠‡¶æ‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶ø‡¶™‡ßç‡¶ü ‡¶ï‡ßã‡¶° ‡¶ö‡¶æ‡¶≤‡¶æ‡¶¨‡ßá
        print("Keep Alive Signal Sent...")
        time.sleep(60)

# ‡¶è‡¶ï‡¶ü‡¶ø ‡¶®‡¶§‡ßÅ‡¶® ‡¶•‡ßç‡¶∞‡ßá‡¶°‡ßá ‡¶è‡¶á ‡¶´‡¶æ‡¶Ç‡¶∂‡¶®‡¶ü‡¶ø ‡¶∞‡¶æ‡¶® ‡¶ï‡¶∞‡¶æ ‡¶π‡¶¨‡ßá
import threading
threading.Thread(target=keep_colab_awake).start()
```


Output:



```text
Collecting python-chess
  Downloading python_chess-1.999-py3-none-any.whl.metadata (776 bytes)
Requirement already satisfied: zstandard in /usr/local/lib/python3.12/dist-packages (0.25.0)
Collecting chess<2,>=1 (from python-chess)
  Downloading chess-1.11.2.tar.gz (6.1 MB)
     ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ 6.1/6.1 MB 50.8 MB/s eta 0:00:00
  Preparing metadata (setup.py) ... done
Downloading python_chess-1.999-py3-none-any.whl (1.4 kB)
Building wheels for collected packages: chess
  Building wheel for chess (setup.py) ... done
  Created wheel for chess: filename=chess-1.11.2-py3-none-any.whl size=147775 sha256=210b7f67b8b06e1be3a64ba00f8b443acbe3c02bef9599da09ef988221203f33
  Stored in directory: /root/.cache/pip/wheels/83/1f/4e/8f4300f7dd554eb8de70ddfed96e94d3d030ace10c5b53d447
Successfully built chess
Installing collected packages: chess, python-chess
Successfully installed chess-1.11.2 python-chess-1.999
Mounted at /content/drive
Working directory: /content/drive/MyDrive/Chessmate_Project/v2
Keep Alive Signal Sent...
```

---

### Cell 2
```python
# ‡¶´‡¶æ‡¶á‡¶≤‡ßá‡¶∞ ‡¶≤‡¶ø‡¶Ç‡¶ï (Lichess Jan 2017)
url = "https://database.lichess.org/standard/lichess_db_standard_rated_2017-01.pgn.zst"
raw_file_path = os.path.join(base_path, "lichess_raw_2017.pgn.zst")

print("Checking file...")
if os.path.exists(raw_file_path):
    print("‚úÖ File already exists! Skipping download.")
else:
    print("‚è≥ Downloading database (1.5 GB)... This may take 5-8 minutes.")
    response = requests.get(url, stream=True)
    with open(raw_file_path, "wb") as f:
        dl = 0
        for chunk in response.iter_content(chunk_size=1024*1024):
            if chunk:
                f.write(chunk)
                dl += 1
                if dl % 100 == 0: print(f"Downloaded {dl} MB...")
    print("‚úÖ Download Complete!")

```


Output:



```text
Checking file...
‚úÖ File already exists! Skipping download.
```

---

### Cell 3
```python

import sqlite3
import json
import time
import shutil
import zstandard as zstd
import chess.pgn
import io
import os

# --- ‡¶ï‡¶®‡¶´‡¶ø‡¶ó‡¶æ‡¶∞‡ßá‡¶∂‡¶® ---
# ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶¨‡¶æ‡¶∞ ‡¶∞‡¶æ‡¶® ‡¶ï‡¶∞‡¶≤‡ßá ‡¶ï‡¶§‡¶ó‡ßÅ‡¶≤‡ßã ‡¶ó‡ßá‡¶Æ ‡¶™‡ßç‡¶∞‡¶∏‡ßá‡¶∏ ‡¶ï‡¶∞‡¶¨‡ßá
GAMES_PER_RUN = 500000
# ‡¶ü‡¶æ‡¶∞‡ßç‡¶ó‡ßá‡¶ü ‡¶™‡¶ú‡¶ø‡¶∂‡¶® (‡ß´‡ß¶ ‡¶≤‡¶ï‡ßç‡¶∑)
TARGET_POSITIONS = 5000000
MIN_ELO = 2000

# ‡¶™‡¶æ‡¶• ‡¶∏‡ßá‡¶ü‡¶Ü‡¶™ (Drive & Local)
drive_path = '/content/drive/MyDrive/Chessmate_Project/v2'
local_db_name = "chessmate_v2.db"
checkpoint_file = "checkpoint.json"

# ‡¶°‡ßç‡¶∞‡¶æ‡¶á‡¶≠ ‡¶™‡¶æ‡¶•
drive_db_path = os.path.join(drive_path, local_db_name)
drive_checkpoint_path = os.path.join(drive_path, checkpoint_file)
raw_file_path = os.path.join(drive_path, "lichess_raw_2017.pgn.zst")

# --- ‡¶´‡¶æ‡¶Ç‡¶∂‡¶® ---

def load_checkpoint():
    if os.path.exists(drive_checkpoint_path):
        with open(drive_checkpoint_path, 'r') as f:
            return json.load(f)
    return {"games_processed": 0, "unique_positions": 0}

def save_checkpoint(games_proc, unique_pos):
    data = {"games_processed": games_proc, "unique_positions": unique_pos}
    with open(drive_checkpoint_path, 'w') as f:
        json.dump(data, f)
    print(f"üìå Checkpoint Saved: {games_proc:,} games processed.")

def process_batch():
    # ‡ßß. ‡¶ö‡ßá‡¶ï‡¶™‡ßü‡ßá‡¶®‡ßç‡¶ü ‡¶≤‡ßã‡¶°
    state = load_checkpoint()
    start_game_index = state['games_processed']
    current_unique_positions = state['unique_positions']

    print(f"üîÑ Resuming from Game #{start_game_index:,}")
    print(f"üìä Current Unique Positions: {current_unique_positions:,}")

    # ‡ß®. ‡¶°‡ßç‡¶∞‡¶æ‡¶á‡¶≠ ‡¶•‡ßá‡¶ï‡ßá ‡¶°‡ßá‡¶ü‡¶æ‡¶¨‡ßá‡¶∏ ‡¶ï‡¶™‡¶ø ‡¶ï‡¶∞‡ßá ‡¶≤‡ßã‡¶ï‡¶æ‡¶≤‡ßá ‡¶Ü‡¶®‡¶æ (‡¶´‡¶æ‡¶∏‡ßç‡¶ü ‡¶∏‡ßç‡¶™‡¶ø‡¶°‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø)
    if os.path.exists(drive_db_path):
        print("üì• Copying Database from Drive to Colab (Faster I/O)...")
        shutil.copy(drive_db_path, local_db_name)

    # ‡ß©. ‡¶°‡ßá‡¶ü‡¶æ‡¶¨‡ßá‡¶∏ ‡¶ï‡¶æ‡¶®‡ßá‡¶ï‡¶∂‡¶®
    conn = sqlite3.connect(local_db_name)
    cursor = conn.cursor()
    cursor.execute('''
        CREATE TABLE IF NOT EXISTS positions (
            fen TEXT PRIMARY KEY,
            stats TEXT
        )
    ''')
    cursor.execute('PRAGMA synchronous = OFF') # ‡¶∏‡ßç‡¶™‡¶ø‡¶° ‡¶¨‡ßÅ‡¶∏‡ßç‡¶ü
    cursor.execute('PRAGMA journal_mode = MEMORY')

    # ‡ß™. ‡¶´‡¶æ‡¶á‡¶≤ ‡¶∞‡¶ø‡¶°‡¶ø‡¶Ç ‡¶è‡¶¨‡¶Ç ‡¶∏‡ßç‡¶ï‡¶ø‡¶™‡¶ø‡¶Ç
    dctx = zstd.ZstdDecompressor()

    with open(raw_file_path, 'rb') as ifh:
        with dctx.stream_reader(ifh) as reader:
            text_stream = io.TextIOWrapper(reader, encoding='utf-8')

            # ‡¶´‡¶æ‡¶∏‡ßç‡¶ü ‡¶∏‡ßç‡¶ï‡¶ø‡¶™‡¶ø‡¶Ç (Fast Forward)
            if start_game_index > 0:
                print(f"‚è© Skipping first {start_game_index:,} games... (Please wait)")
                skipped = 0
                while skipped < start_game_index:
                    # read_headers ‡¶¶‡ßç‡¶∞‡ßÅ‡¶§ ‡¶∏‡ßç‡¶ï‡¶ø‡¶™ ‡¶ï‡¶∞‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá
                    if chess.pgn.read_headers(text_stream) is None:
                        print("‚ùå End of file reached during skipping!")
                        return
                    skipped += 1
                    if skipped % 50000 == 0: print(f"   Skipped {skipped:,} games...")
                print("‚úÖ Skipping complete. Processing new games...")

            # ‡¶®‡¶§‡ßÅ‡¶® ‡¶ó‡ßá‡¶Æ ‡¶™‡ßç‡¶∞‡¶∏‡ßá‡¶∏‡¶ø‡¶Ç
            games_in_this_batch = 0
            batch_data = []

            while games_in_this_batch < GAMES_PER_RUN:
                try:
                    game = chess.pgn.read_game(text_stream)
                    if game is None: break

                    # ‡¶™‡ßç‡¶∞‡¶∏‡ßá‡¶∏‡¶ø‡¶Ç ‡¶≤‡¶ú‡¶ø‡¶ï (‡¶Ü‡¶ó‡ßá‡¶∞ ‡¶Æ‡¶§‡ßã‡¶á)
                    headers = game.headers
                    try:
                        white_elo = int(headers.get("WhiteElo", 0))
                        black_elo = int(headers.get("BlackElo", 0))
                    except: continue

                    if white_elo >= MIN_ELO and black_elo >= MIN_ELO:
                        board = game.board()
                        result = headers.get("Result")

                        for i, move in enumerate(game.mainline_moves()):
                            if i > 20: break

                            fen = board.fen()
                            move_san = board.san(move)
                            clean_fen = " ".join(fen.split(" ")[:4])

                            # ‡¶Ü‡¶Æ‡¶∞‡¶æ ‡¶∏‡¶∞‡¶æ‡¶∏‡¶∞‡¶ø ‡¶¨‡ßç‡¶Ø‡¶æ‡¶ö‡ßá ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡¶¨, ‡¶™‡¶∞‡ßá DB ‡¶§‡ßá ‡¶Æ‡¶æ‡¶∞‡ßç‡¶ú ‡¶ï‡¶∞‡¶¨
                            # (‡¶∏‡¶π‡¶ú ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶Ü‡¶Æ‡¶∞‡¶æ ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶∏‡¶∞‡¶æ‡¶∏‡¶∞‡¶ø SQL Upsert ‡¶≤‡¶ú‡¶ø‡¶ï ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶¨ ‡¶®‡¶æ,
                            # ‡¶¨‡¶∞‡¶Ç Python ‡¶è ‡¶™‡ßç‡¶∞‡¶∏‡ßá‡¶∏ ‡¶ï‡¶∞‡ßá ‡¶¨‡ßç‡¶Ø‡¶æ‡¶ö ‡¶á‡¶®‡¶∏‡¶æ‡¶∞‡ßç‡¶ü ‡¶ï‡¶∞‡¶¨)

                            # ‡¶®‡ßã‡¶ü: ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶ú‡¶ü‡¶ø‡¶≤‡¶§‡¶æ ‡¶ï‡¶Æ‡¶æ‡¶®‡ßã‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶∏‡¶∞‡¶æ‡¶∏‡¶∞‡¶ø DB ‡¶§‡ßá ‡¶ï‡ßÅ‡ßü‡ßá‡¶∞‡¶ø ‡¶ï‡¶∞‡¶õ‡¶ø ‡¶®‡¶æ‡•§
                            # ‡¶Ü‡¶Æ‡¶∞‡¶æ ‡¶ß‡¶∞‡ßá ‡¶®‡¶ø‡¶ö‡ßç‡¶õ‡¶ø ‡¶°‡ßÅ‡¶™‡ßç‡¶≤‡¶ø‡¶ï‡ßá‡¶ü ‡¶π‡¶≤‡ßá SQLite ‡¶π‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶°‡ßá‡¶≤ ‡¶ï‡¶∞‡¶¨‡ßá (INSERT OR IGNORE)
                            # ‡¶ï‡¶ø‡¶®‡ßç‡¶§‡ßÅ ‡¶∏‡¶†‡¶ø‡¶ï ‡¶∏‡ßç‡¶ü‡ßç‡¶Ø‡¶æ‡¶ü‡¶∏ ‡¶Ü‡¶™‡¶°‡ßá‡¶ü‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶Ü‡¶Æ‡¶æ‡¶¶‡ßá‡¶∞ ‡¶∞‡¶ø‡¶° ‡¶ï‡¶∞‡¶§‡ßá ‡¶π‡¶¨‡ßá‡•§
                            # ‡¶∏‡ßç‡¶™‡¶ø‡¶°‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶Ü‡¶Æ‡¶∞‡¶æ ‡¶è‡¶á ‡¶¨‡ßç‡¶Ø‡¶æ‡¶ö‡ßá ‡¶∂‡ßÅ‡¶ß‡ßÅ ‡¶®‡¶§‡ßÅ‡¶® ‡¶™‡¶ú‡¶ø‡¶∂‡¶®‡¶ó‡ßÅ‡¶≤‡ßã ‡¶¨‡¶æ‡¶´‡¶æ‡¶∞‡ßá ‡¶∞‡¶æ‡¶ñ‡¶¨‡•§

                            # (‡¶è‡¶á ‡¶Ö‡¶Ç‡¶∂‡ßá‡¶∞ ‡¶≤‡¶ú‡¶ø‡¶ï ‡¶è‡¶ï‡¶ü‡ßÅ ‡¶ú‡¶ü‡¶ø‡¶≤, ‡¶§‡¶æ‡¶á ‡¶∏‡¶π‡¶ú 'RAM Cache' ‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡¶õ‡¶ø)
                            # ‡¶∏‡¶ø‡¶Æ‡ßç‡¶™‡¶≤‡¶ø‡¶∏‡¶ø‡¶ü‡¶ø‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø: ‡¶Ü‡¶Æ‡¶∞‡¶æ ‡¶™‡ßç‡¶∞‡¶§‡¶ø ‡¶ó‡ßá‡¶Æ‡ßá‡¶∞ ‡¶™‡¶ú‡¶ø‡¶∂‡¶®‡¶ó‡ßÅ‡¶≤‡ßã ‡¶¨‡ßç‡¶Ø‡¶æ‡¶ö‡ßá ‡¶∞‡¶æ‡¶ñ‡¶õ‡¶ø

                            # *PRO TIP*: ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶Ü‡¶Æ‡¶∞‡¶æ ‡¶¨‡ßç‡¶Ø‡¶æ‡¶ö ‡¶á‡¶®‡¶∏‡¶æ‡¶∞‡ßç‡¶ü ‡¶®‡¶æ ‡¶ï‡¶∞‡ßá ‡¶∏‡¶∞‡¶æ‡¶∏‡¶∞‡¶ø ‡¶Ü‡¶™‡¶°‡ßá‡¶ü ‡¶ï‡¶∞‡¶¨
                            # ‡¶ï‡¶æ‡¶∞‡¶£ ‡¶°‡ßÅ‡¶™‡ßç‡¶≤‡¶ø‡¶ï‡ßá‡¶ü ‡¶™‡¶ú‡¶ø‡¶∂‡¶® ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡¶æ ‡¶ú‡¶∞‡ßÅ‡¶∞‡¶ø‡•§

                            cursor.execute('SELECT stats FROM positions WHERE fen = ?', (clean_fen,))
                            row = cursor.fetchone()

                            if row:
                                stats = json.loads(row[0])
                            else:
                                stats = {"total": 0, "moves": {}}
                                current_unique_positions += 1

                            if move_san not in stats["moves"]:
                                stats["moves"][move_san] = {"white": 0, "black": 0, "draw": 0}

                            stats["total"] += 1
                            if result == '1-0': stats["moves"][move_san]["white"] += 1
                            elif result == '0-1': stats["moves"][move_san]["black"] += 1
                            else: stats["moves"][move_san]["draw"] += 1

                            cursor.execute('INSERT OR REPLACE INTO positions VALUES (?, ?)', (clean_fen, json.dumps(stats)))
                            board.push(move)

                    games_in_this_batch += 1
                    if games_in_this_batch % 5000 == 0:
                        conn.commit()
                        print(f"   Processed {games_in_this_batch:,} games in this run...")

                except Exception as e:
                    continue

    # ‡ß´. ‡¶∏‡ßá‡¶≠ ‡¶è‡¶¨‡¶Ç ‡¶ï‡ßç‡¶≤‡¶ø‡¶®‡¶Ü‡¶™
    conn.commit()
    conn.close()

    total_processed = start_game_index + games_in_this_batch

    print("üíæ Saving Database to Google Drive...")
    shutil.copy(local_db_name, drive_db_path)

    save_checkpoint(total_processed, current_unique_positions)

    print(f"\nüéâ Batch Complete!")
    print(f"Total Games Processed So Far: {total_processed:,}")
    print(f"Total Unique Positions: {current_unique_positions:,}")
    print("‚úÖ Run this cell again to process the next batch!")

# ‡¶∞‡¶æ‡¶® ‡¶ï‡¶∞‡¶æ
process_batch()

```


Output:



```text
üîÑ Resuming from Game #4,500,000
üìä Current Unique Positions: 2,275,527
üì• Copying Database from Drive to Colab (Faster I/O)...
‚è© Skipping first 4,500,000 games... (Please wait)
   Skipped 50,000 games...
   Skipped 100,000 games...
   Skipped 150,000 games...
   Skipped 200,000 games...
   Skipped 250,000 games...
   Skipped 300,000 games...
Keep Alive Signal Sent...
   Skipped 350,000 games...
   Skipped 400,000 games...
   Skipped 450,000 games...
Keep Alive Signal Sent...
   Skipped 500,000 games...
   Skipped 550,000 games...
   Skipped 600,000 games...
   Skipped 650,000 games...
   Skipped 700,000 games...
   Skipped 750,000 games...
   Skipped 800,000 games...
   Skipped 850,000 games...
   Skipped 900,000 games...
   Skipped 950,000 games...
   Skipped 1,000,000 games...
   Skipped 1,050,000 games...
   Skipped 1,100,000 games...
   Skipped 1,150,000 games...
   Skipped 1,200,000 games...
   Skipped 1,250,000 games...
   Skipped 1,300,000 games...
   Skipped 1,350,000 games...
Keep Alive Signal Sent...
   Skipped 1,400,000 games...
   Skipped 1,450,000 games...
   Skipped 1,500,000 games...
Keep Alive Signal Sent...
   Skipped 1,550,000 games...
   Skipped 1,600,000 games...
   Skipped 1,650,000 games...
   Skipped 1,700,000 games...
   Skipped 1,750,000 games...
   Skipped 1,800,000 games...
   Skipped 1,850,000 games...
   Skipped 1,900,000 games...
   Skipped 1,950,000 games...
   Skipped 2,000,000 games...
   Skipped 2,050,000 games...
   Skipped 2,100,000 games...
   Skipped 2,150,000 games...
   Skipped 2,200,000 games...
   Skipped 2,250,000 games...
   Skipped 2,300,000 games...
   Skipped 2,350,000 games...
Keep Alive Signal Sent...
   Skipped 2,400,000 games...
   Skipped 2,450,000 games...
   Skipped 2,500,000 games...
   Skipped 2,550,000 games...
Keep Alive Signal Sent...
   Skipped 2,600,000 games...
   Skipped 2,650,000 games...
   Skipped 2,700,000 games...
   Skipped 2,750,000 games...
   Skipped 2,800,000 games...
   Skipped 2,850,000 games...
   Skipped 2,900,000 games...
   Skipped 2,950,000 games...
   Skipped 3,000,000 games...
   Skipped 3,050,000 games...
   Skipped 3,100,000 games...
   Skipped 3,150,000 games...
   Skipped 3,200,000 games...
   Skipped 3,250,000 games...
   Skipped 3,300,000 games...
   Skipped 3,350,000 games...
Keep Alive Signal Sent...
   Skipped 3,400,000 games...
   Skipped 3,450,000 games...
   Skipped 3,500,000 games...
   Skipped 3,550,000 games...
Keep Alive Signal Sent...
   Skipped 3,600,000 games...
   Skipped 3,650,000 games...
   Skipped 3,700,000 games...
   Skipped 3,750,000 games...
   Skipped 3,800,000 games...
   Skipped 3,850,000 games...
   Skipped 3,900,000 games...
   Skipped 3,950,000 games...
   Skipped 4,000,000 games...
   Skipped 4,050,000 games...
   Skipped 4,100,000 games...
   Skipped 4,150,000 games...
   Skipped 4,200,000 games...
   Skipped 4,250,000 games...
   Skipped 4,300,000 games...
   Skipped 4,350,000 games...
   Skipped 4,400,000 games...
   Skipped 4,450,000 games...
Keep Alive Signal Sent...
   Skipped 4,500,000 games...
‚úÖ Skipping complete. Processing new games...
Keep Alive Signal Sent...
   Processed 5,000 games in this run...
   Processed 10,000 games in this run...
   Processed 15,000 games in this run...
   Processed 20,000 games in this run...
Keep Alive Signal Sent...
Keep Alive Signal Sent...
   Processed 25,000 games in this run...
   Processed 30,000 games in this run...
   Processed 35,000 games in this run...
Keep Alive Signal Sent...
   Processed 40,000 games in this run...
Keep Alive Signal Sent...
   Processed 45,000 games in this run...
   Processed 50,000 games in this run...
   Processed 55,000 games in this run...
Keep Alive Signal Sent...
   Processed 60,000 games in this run...
Keep Alive Signal Sent...
   Processed 65,000 games in this run...
   Processed 70,000 games in this run...
   Processed 75,000 games in this run...
Keep Alive Signal Sent...
   Processed 80,000 games in this run...
Keep Alive Signal Sent...
   Processed 85,000 games in this run...
   Processed 90,000 games in this run...
   Processed 95,000 games in this run...
Keep Alive Signal Sent...
   Processed 100,000 games in this run...
Keep Alive Signal Sent...
   Processed 105,000 games in this run...
   Processed 110,000 games in this run...
   Processed 115,000 games in this run...
Keep Alive Signal Sent...
   Processed 120,000 games in this run...
Keep Alive Signal Sent...
   Processed 125,000 games in this run...
   Processed 130,000 games in this run...
   Processed 135,000 games in this run...
Keep Alive Signal Sent...
   Processed 140,000 games in this run...
Keep Alive Signal Sent...
   Processed 145,000 games in this run...
   Processed 150,000 games in this run...
   Processed 155,000 games in this run...
Keep Alive Signal Sent...
   Processed 160,000 games in this run...
Keep Alive Signal Sent...
   Processed 165,000 games in this run...
   Processed 170,000 games in this run...
   Processed 175,000 games in this run...
Keep Alive Signal Sent...
   Processed 180,000 games in this run...
Keep Alive Signal Sent...
   Processed 185,000 games in this run...
   Processed 190,000 games in this run...
   Processed 195,000 games in this run...
Keep Alive Signal Sent...
   Processed 200,000 games in this run...
Keep Alive Signal Sent...
   Processed 205,000 games in this run...
   Processed 210,000 games in this run...
   Processed 215,000 games in this run...
Keep Alive Signal Sent...
   Processed 220,000 games in this run...
Keep Alive Signal Sent...
   Processed 225,000 games in this run...
   Processed 230,000 games in this run...
   Processed 235,000 games in this run...
Keep Alive Signal Sent...
Keep Alive Signal Sent...
   Processed 240,000 games in this run...
   Processed 245,000 games in this run...
   Processed 250,000 games in this run...
   Processed 255,000 games in this run...
Keep Alive Signal Sent...
Keep Alive Signal Sent...
   Processed 260,000 games in this run...
   Processed 265,000 games in this run...
   Processed 270,000 games in this run...
Keep Alive Signal Sent...
   Processed 275,000 games in this run...
Keep Alive Signal Sent...
   Processed 280,000 games in this run...
   Processed 285,000 games in this run...
   Processed 290,000 games in this run...
Keep Alive Signal Sent...
   Processed 295,000 games in this run...
Keep Alive Signal Sent...
   Processed 300,000 games in this run...
   Processed 305,000 games in this run...
   Processed 310,000 games in this run...
Keep Alive Signal Sent...
Keep Alive Signal Sent...
   Processed 315,000 games in this run...
   Processed 320,000 games in this run...
   Processed 325,000 games in this run...
   Processed 330,000 games in this run...
Keep Alive Signal Sent...
Keep Alive Signal Sent...
   Processed 335,000 games in this run...
   Processed 340,000 games in this run...
   Processed 345,000 games in this run...
   Processed 350,000 games in this run...
Keep Alive Signal Sent...
Keep Alive Signal Sent...
   Processed 355,000 games in this run...
   Processed 360,000 games in this run...
   Processed 365,000 games in this run...
   Processed 370,000 games in this run...
Keep Alive Signal Sent...
Keep Alive Signal Sent...
   Processed 375,000 games in this run...
   Processed 380,000 games in this run...
   Processed 385,000 games in this run...
   Processed 390,000 games in this run...
Keep Alive Signal Sent...
Keep Alive Signal Sent...
   Processed 395,000 games in this run...
   Processed 400,000 games in this run...
   Processed 405,000 games in this run...
   Processed 410,000 games in this run...
Keep Alive Signal Sent...
Keep Alive Signal Sent...
   Processed 415,000 games in this run...
   Processed 420,000 games in this run...
   Processed 425,000 games in this run...
Keep Alive Signal Sent...
   Processed 430,000 games in this run...
Keep Alive Signal Sent...
   Processed 435,000 games in this run...
   Processed 440,000 games in this run...
   Processed 445,000 games in this run...
Keep Alive Signal Sent...
   Processed 450,000 games in this run...
Keep Alive Signal Sent...
   Processed 455,000 games in this run...
   Processed 460,000 games in this run...
   Processed 465,000 games in this run...
Keep Alive Signal Sent...
   Processed 470,000 games in this run...
Keep Alive Signal Sent...
   Processed 475,000 games in this run...
   Processed 480,000 games in this run...
   Processed 485,000 games in this run...
Keep Alive Signal Sent...
   Processed 490,000 games in this run...
Keep Alive Signal Sent...
   Processed 495,000 games in this run...
   Processed 500,000 games in this run...
üíæ Saving Database to Google Drive...
üìå Checkpoint Saved: 5,000,000 games processed.

üéâ Batch Complete!
Total Games Processed So Far: 5,000,000
Total Unique Positions: 2,488,753
‚úÖ Run this cell again to process the next batch!
```

---

### Cell 4
```python

# Cell 4: Uploading the V2 Database to Hugging Face
from huggingface_hub import HfApi
import os

# --- ‡¶ï‡¶®‡¶´‡¶ø‡¶ó‡¶æ‡¶∞‡ßá‡¶∂‡¶® ---
# ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶ü‡ßã‡¶ï‡ßá‡¶®‡¶ü‡¶ø ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶¶‡¶ø‡¶® (‡¶Ö‡¶¨‡¶∂‡ßç‡¶Ø‡¶á Write ‡¶™‡¶æ‡¶∞‡¶Æ‡¶ø‡¶∂‡¶® ‡¶ì‡ßü‡¶æ‡¶≤‡¶æ)
HF_TOKEN = "MY_HF_TOKEN"

# ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶á‡¶â‡¶ú‡¶æ‡¶∞‡¶®‡ßá‡¶Æ
HF_USERNAME = "Rafs-an09002"
REPO_ID = f"{HF_USERNAME}/chessmate-data-v2"

# ‡¶´‡¶æ‡¶á‡¶≤‡ßá‡¶∞ ‡¶∏‡¶†‡¶ø‡¶ï ‡¶™‡¶æ‡¶• (‡¶Ø‡ßá‡¶ñ‡¶æ‡¶®‡ßá ‡¶Ü‡¶Æ‡¶∞‡¶æ ‡¶∏‡ßá‡¶≠ ‡¶ï‡¶∞‡ßá‡¶õ‡¶ø)
base_path = '/content/drive/MyDrive/Chessmate_Project/v2'
db_filename = "chessmate_v2.db"
db_path = os.path.join(base_path, db_filename)

api = HfApi(token=HF_TOKEN)

print(f"üöÄ Starting Upload to: {REPO_ID}")
print(f"üìÇ File: {db_path}")
print(f"‚öñÔ∏è Size: {os.path.getsize(db_path) / (1024*1024):.2f} MB")
print("‚è≥ This may take a while depending on file size...")

try:
    # ‡ßß. ‡¶∞‡¶ø‡¶™‡ßã‡¶ú‡¶ø‡¶ü‡¶∞‡¶ø ‡¶§‡ßà‡¶∞‡¶ø (‡¶Ø‡¶¶‡¶ø ‡¶®‡¶æ ‡¶•‡¶æ‡¶ï‡ßá)
    api.create_repo(repo_id=REPO_ID, repo_type="dataset", exist_ok=True)

    # ‡ß®. ‡¶´‡¶æ‡¶á‡¶≤ ‡¶Ü‡¶™‡¶≤‡ßã‡¶° (Direct Stream)
    # ‡¶Ü‡¶Æ‡¶∞‡¶æ ‡¶´‡¶æ‡¶á‡¶≤‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶® ‡¶ï‡¶∞‡ßá 'chess_stats_v2.db' ‡¶¶‡¶ø‡¶ö‡ßç‡¶õ‡¶ø ‡¶≠‡¶æ‡¶∞‡ßç‡¶∏‡¶® ‡¶ü‡ßç‡¶∞‡ßç‡¶Ø‡¶æ‡¶ï‡¶ø‡¶Ç‡ßü‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø
    api.upload_file(
        path_or_fileobj=db_path,
        path_in_repo="chess_stats_v2.db",
        repo_id=REPO_ID,
        repo_type="dataset"
    )

    print("\n‚úÖ UPLOAD SUCCESSFUL!")
    print("üéâ Your massive dataset is now secured on Hugging Face.")
    print(f"üîó URL: https://huggingface.co/datasets/{REPO_ID}/resolve/main/chess_stats_v2.db")

except Exception as e:
    print(f"\n‚ùå Upload Failed: {e}")
    print("Tip: Check if your Token has 'WRITE' permission.")
```


Output:



```text
üöÄ Starting Upload to: Rafs-an09002/chessmate-data-v2
üìÇ File: /content/drive/MyDrive/Chessmate_Project/v2/chessmate_v2.db
‚öñÔ∏è Size: 882.46 MB
‚è≥ This may take a while depending on file size...
/usr/local/lib/python3.12/dist-packages/huggingface_hub/utils/_auth.py:94: UserWarning: 
The secret `HF_TOKEN` does not exist in your Colab secrets.
To authenticate with the Hugging Face Hub, create a token in your settings tab (https://huggingface.co/settings/tokens), set it as secret in your Google Colab and restart your session.
You will be able to reuse this secret in all of your notebooks.
Please note that authentication is recommended but still optional to access public models or datasets.
  warnings.warn(
Processing‚ÄáFiles‚Äá(1‚Äá/‚Äá1)‚Äá‚Äá‚Äá‚Äá‚Äá‚Äá:‚Äá100%
‚Äá‚Äá925MB‚Äá/‚Äá‚Äá925MB,‚Äá‚Äá201MB/s‚Äá‚Äá
New‚ÄáData‚ÄáUpload‚Äá‚Äá‚Äá‚Äá‚Äá‚Äá‚Äá‚Äá‚Äá‚Äá‚Äá‚Äá‚Äá‚Äá‚Äá:‚Äá
‚Äá‚Äá0.00B‚Äá/‚Äá‚Äá0.00B,‚Äá‚Äá0.00B/s‚Äá‚Äá
‚Äá‚Äá...roject/v2/chessmate_v2.db:‚Äá100%
‚Äá‚Äá925MB‚Äá/‚Äá‚Äá925MB‚Äá‚Äá‚Äá‚Äá‚Äá‚Äá‚Äá‚Äá‚Äá‚Äá‚Äá‚Äá
No files have been modified since last commit. Skipping to prevent empty commit.
WARNING:huggingface_hub.hf_api:No files have been modified since last commit. Skipping to prevent empty commit.

‚úÖ UPLOAD SUCCESSFUL!
üéâ Your massive dataset is now secured on Hugging Face.
üîó URL: https://huggingface.co/datasets/Rafs-an09002/chessmate-data-v2/resolve/main/chess_stats_v2.db
```

